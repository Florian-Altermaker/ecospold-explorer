function emptyPage(){let e=document.getElementById("parameters"),t=e.getElementsByClassName("parameters-block");if(t.length>1&&t[1].remove(),t.length>0){let r=t[0];r.innerHTML="";let o=document.createElement("h2");o.textContent="API service not available, please contact an administrator",r.appendChild(o)}}function updateActivityKeywordsIDs(){let e=document.querySelectorAll('div[id^="prm-activity-keyword-"]');e.forEach((e,t)=>{let r=t+1;e.id=`prm-activity-keyword-${r}`;let o=e.querySelector(".remove-button");o&&(o.id=`remove-${r}`);let a=e.querySelector(".activity-keyword-rule");a&&(a.name=`activity-keyword-rule-${r}`);let l=e.querySelector(".activity-keyword-value");l&&(l.name=`activity-keyword-value-${r}`)})}function updateReferenceFlowKeywordsIDs(){let e=document.querySelectorAll('div[id^="prm-reference-flow-keyword-"]');e.forEach((e,t)=>{let r=t+1;e.id=`prm-reference-flow-keyword-${r}`;let o=e.querySelector(".remove-button");o&&(o.id=`remove-${r}`);let a=e.querySelector(".reference-flow-keyword-rule");a&&(a.name=`reference-flow-keyword-rule-${r}`);let l=e.querySelector(".reference-flow-keyword-value");l&&(l.name=`reference-flow-keyword-value-${r}`)})}function updateIntermediateExchangeKeywordsIDs(){let e=document.querySelectorAll('div[id^="prm-intermediate-exchange-keyword-"]');e.forEach((e,t)=>{let r=t+1;e.id=`prm-intermediate-exchange-keyword-${r}`;let o=e.querySelector(".remove-button");o&&(o.id=`remove-${r}`);let a=e.querySelector(".intermediate-exchange-keyword-rule");a&&(a.name=`intermediate-exchange-keyword-rule-${r}`);let l=e.querySelector(".intermediate-exchange-keyword-value");l&&(l.name=`intermediate-exchange-keyword-value-${r}`)})}function updateImpactCategoriesIDs(){let e=document.querySelectorAll('div[id^="prm-impact-category-"]');e.forEach((e,t)=>{let r=t+1;e.id=`prm-impact-category-${r}`;let o=e.querySelector(".remove-button");o&&(o.id=`remove-${r}`);let a=e.querySelector(".impact-category-package");a&&(a.name=`impact-category-package-${r}`);let l=e.querySelector(".impact-category-rule");l&&(l.name=`impact-category-rule-${r}`);let i=e.querySelector(".impact-category-value");i&&(i.name=`impact-category-value-${r}`)})}function updateElementaryFlowsIDs(){let e=document.querySelectorAll('div[id^="prm-elementary-flow-"]');e.forEach((e,t)=>{let r=t+1;e.id=`prm-elementary-flow-${r}`;let o=e.querySelector(".remove-button");o&&(o.id=`remove-${r}`);let a=e.querySelector(".elementary-flow-rule");a&&(a.name=`elementary-flow-rule-${r}`);let l=e.querySelector(".elementary-flow-value");l&&(l.name=`elementary-flow-value-${r}`)})}function populateImpactCategories(e){try{let t=sessionStorage.getItem("impactCategories");if(!t)throw Error("No impactCategories data found in session storage");let r=JSON.parse(t),o=document.getElementById(e);if(!o)throw Error(`Parent element with id "${e}" not found`);let a=o.querySelector(".select-2");if(!a)throw Error(`Select element with class "select-2" not found inside parent element with id "${e}"`);a.innerHTML="";let l=document.createElement("option");l.value="0",l.textContent="-",a.appendChild(l),Object.keys(r).forEach(e=>{let t=document.createElement("option");t.value=e,t.textContent=e,a.appendChild(t)})}catch(i){console.error("Error populating impact categories:",i),popToast("Error populating impact categories")}}async function fetchImpactCategories(e){try{let t="api.php?request=get-indicators&source="+encodeURIComponent(e),r=await fetch(t);if(!r.ok)throw Error("Failed to fetch data");let o=await r.json();sessionStorage.setItem("impactCategories",JSON.stringify(o.data))}catch(a){console.error("Error fetching or storing data:",a),popToast("Error fetching or storing data")}}async function fetchElementaryFlows(e){try{let t="api.php?request=get-elementary-flows&source="+encodeURIComponent(e),r=await fetch(t);if(!r.ok)throw Error("Failed to fetch data");let o=await r.json();sessionStorage.setItem("elementaryFlows",JSON.stringify(o.data))}catch(a){console.error("Error fetching or storing data:",a)}}function populateIndicators(e){try{let t=document.getElementById(e);if(!t)throw Error(`Parent element with id "${e}" not found`);let r=t.querySelector(".impact-category");if(!r)throw Error(`Element with class "impact-category" not found inside parent element with id "${e}"`);let o=r.value,a=sessionStorage.getItem("impactCategories");if(!a)throw Error("No impactCategories data found in session storage");let l=JSON.parse(a),i=l[o];if(!i)throw Error(`No names found for key "${o}" in impactCategories`);let n=t.querySelector(".indicator");if(!n)throw Error(`Element with class "indicator" not found inside parent element with id "${e}"`);n.innerHTML="",i.forEach(e=>{let t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)})}catch(c){console.error("Error populating indicator:",c),popToast("Error populating indicator")}}function populateElementaryFlows(){let e=sessionStorage.getItem("elementaryFlows");if(!e){console.log("No elementaryFlows data found in session storage");return}let t=JSON.parse(e);document.querySelectorAll(".autocomplete:not([data-autocomplete-initialized])").forEach(e=>{new autoComplete({data:{src:t},selector:()=>e,resultItem:{highlight:!0},events:{input:{selection(t){let r=t.detail.selection.value;e.value=r}}}}),e.setAttribute("data-autocomplete-initialized",!0)})}function popToast(e){let t=document.createElement("div");t.classList.add("toast");let r=document.createElement("span");r.textContent=e,t.innerHTML=`<svg width="25px" height="25px" stroke-width="1.7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="#ffffff"><path d="M12 11.5V16.5" stroke="#ffffff" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 7.51L12.01 7.49889" stroke="#ffffff" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#ffffff" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"></path></svg><span>${e}</span>`,document.body.appendChild(t)}